# Сопоставляем коммиты  

__*Тема 7/8 Урок 2/4*__  

В этом уроке вы допишете сказку «Теремок», а также научитесь сопоставлять коммиты. Если вдруг на каком-то этапе работы возникнет проблема, это поможет разобраться, что конкретно изменилось в одном коммите по сравнению с другим.  

## Дописываем строку в файл  

Чтобы продолжить сказку, вам нужно будет дописывать новые строки в конец файла `teremok.txt`. Для этого подходит команда `echo` (англ. «эхо»). Разберём её.  

Сама по себе эта команда просто выводит в консоль то, что ей передали в качестве параметра.

```text
$ echo "Привет!"
Привет! 
```

Но если скомбинировать `echo` с символами перенаправления вывода `>>` (два знака «больше»), то всё, что должно было попасть на экран, вместо этого будет записано в файл.  

```text
$ cat file.txt
Первая строка файла

$ echo "Вторая строка файла" >> file.txt
$ cat file.txt
Первая строка файла
Вторая строка файла 
```

Оператор `>>` — это возможность командной строки (__Bash__). Его можно использовать не только с `echo`, но и с любой другой командой, которая выводит что-то на экран.  

Одинарный символ `>` тоже перенаправит вывод команды в файл, но перед этим сотрёт содержимое файла, то есть перезапишет файл целиком.  

```text
$ cat file.txt
Первая строка файла
$ echo "Новая строка" > file.txt
$ cat file.txt
Новая строка
```

Обратите внимание, что после использования символа `>` `Первая строка файла` исчезла.  

## Селим всех остальных  

Вернёмся к сказке. Сделайте по коммиту для каждого нового персонажа. Используйте команду `echo` или дописывайте строки вручную в любом текстовом редакторе.  

```text
$ echo "Лягушка-квакушка" >> teremok.txt
$ git add teremok.txt
$ git commit -m "Поселить лягушку-квакушку"
# пропускаем вывод команды commit

$ echo "Зайчик-побегайчик" >> teremok.txt
$ git add teremok.txt
$ git commit -m "Поселить зайчика-побегайчика"

$ echo "Лисичка-сестричка" >> teremok.txt
$ git add teremok.txt
$ git commit -m "Поселить лисичку-сестричку"

$ echo "Волчок -- серый бочок" >> teremok.txt
$ git add teremok.txt
$ git commit -m "Поселить волчка -- серого бочка"

# Пришла очередь медведя косолапого.
# Как известно, конструкция теремка не была рассчитана на массу медведя
# и теремок развалился.
# Обратите внимание на одинарный символ >
$ echo "Теремок развален" > teremok.txt
$ git add teremok.txt
$ git commit -m "Попытаться поселить медведя косолапого" 
```

Если сейчас выполнить команду `git log --oneline`, получится примерно следующее:  

```text
$ git log --oneline
48fe3dc (HEAD -> master) Попытаться поселить медведя косолапого
318ebdb Поселить волчка -- серого бочка
470c115 Поселить лисичку-сестричку
e4ede9c Поселить зайчика-побегайчика
31cf9b3 Поселить лягушку-квакушку
d7d797a Поселить мышку-норушку
1c29af6 Исходное состояние теремка 
```

Обратите внимание: у вас могут быть другие хеши, потому что они зависят в том числе от автора и времени, когда был сделан коммит.  

## Сравниваем коммиты  

Теперь, когда сказка рассказана и у вас есть история коммитов, попробуйте сравнить состояния файла `teremok.txt` между коммитами.  
Например, чтобы получить максимально сокращённую версию сказки, можно сравнить состояние файлов на момент первого коммита (у нас это `1c29af6`) и последнего (у нас `48fe3dc`). __Ваши хеши могут отличаться__.  

Передайте команде `git diff` хеши обоих коммитов. Состояние файлов на момент первого переданного коммита будет сравниваться с состоянием файлов на момент второго.  

Вместо `48fe3dc` можно было использовать `HEAD`: `git diff 1c29af6 HEAD`, потому что `HEAD` указывает на последний коммит.  

Если коротко, это сказка о том, как теремок был и его не стало. А теперь попробуйте узнать, кто подселялся между __лягушкой-квакушкой__ и __волчком — серым бочком__. Используйте соответствующие хеши коммитов.

Подселились: __зайчик-побегайчик__, __лисичка-сестричка__ и __волчок — серый бочок__. Чёрные строки без знаков `+` или `-` — это «контекст», его `git diff` выводит только для того, чтобы стало понятно, что находится рядом с изменёнными (зелёными и красными) строками.  

## Порядок аргументов `git diff`  

По сути команда `git diff A B` выводит список инструкций: как превратить состояние `A` в состояние `B`. Если поменять `A` и `B` местами (`git diff B A`), то и инструкции будут обратные: как превратить `B` в `A`. При этом все зелёные строки станут красными, и наоборот.  
Попробуйте `git diff <конец сказки> <начало>`. Вместо `HEAD` (конец сказки) можно также передать хеш.  

Готово! Всё равно, как если бы мы рассказали историю задом наперёд.
Вот и сказке конец, а кто с нами коммитил — молодец!

---
> `git log --oneline` показывает первые несколько символов хеша и сообщение коммита.  
>Этой командой можно воспользоваться, когда не нужен полный хеш.  
> `git diff --staged` показывает, что изменилось в проиндексированных файлах.  
>Ключ `--staged` говорит системе, что нужно смотреть изменения, которые были добавлены в `staged`.  
> `git diff a9928ab 11bada1` покажет различия коммитов с хешами `a9928ab` и `11bada1`.  
>В зависимости от того, в каком порядке переданы коммиты, это будут или внесённые правки, или информация о том, что нужно «откатить».  
